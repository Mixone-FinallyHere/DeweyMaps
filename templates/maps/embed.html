<!DOCTYPE html>
<html>
{% load leaflet_tags %}

<head>
    {% leaflet_js %}
    {% leaflet_css %}
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <style type="text/css">
      body {
        border: 2px solid #ccc;
        margin: 0;
        padding: 0;
        font-family: "Arial";
        border-bottom: 0;
      }

      header {
        background-color: #eee;
        margin: 0;
        padding-left: 0.5em;
        padding-right: 0.3em;
      }

      header a{
        color: #0078A8;
      }

      h1 {
        margin: 0;
      }

      #r {
        float: right;
        text-align: right;
      }

      #r a{
        font-size: 0.7em;
        text-decoration: none;
      }

      #r a:hover {
        text-decoration: underline;
      }
      .leaflet-container {
        margin: 0;
        height: 100% !important;
      }

    </style>


<script type="text/javascript">
    map_id = "{{map.id}}";

    function map_init (map, options) {
      $.ajax({
        url: "/api/maps/" + map_id
      }).done(function(ret) {
        for (var i in ret.markers) {
            marker = ret.markers[i];
            L.marker([marker.lat, marker.lon]).addTo(map);
        }
      });
    }
</script>

</head>

<body>
<header>

  <div id="r">
    <a href="">Un probl√®me ? </a> <br>
    <a href="">Ajouter un point </a>
  </div>
  <h1>{{map.name}}</h1>
</header>
{% leaflet_map "frame" callback="window.map_init" %}

<ul>
{% for marker in map.marker_set.all %}
  <li>{{marker.name}}</li>
{% endfor %}
</ul>
</body>
</html>
